<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Cartoon Speaker</title>
    <style>
        body {
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(180deg, #f7fbff, #e6f0ff);
            color: #08325a;
            gap: 24px;
            flex-direction: column;
        }

        .container {
            text-align: center;
            width: 360px;
            max-width: 94%;
        }

        button#showBtn {
            background: linear-gradient(90deg, #ff8a00, #ff3d7f);
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 18px;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.12);
            transition: transform .12s ease, box-shadow .12s ease;
        }

        button#showBtn:active {
            transform: translateY(2px);
            box-shadow: 0 3px 9px rgba(0, 0, 0, 0.10);
        }

        .stage {
            margin-top: 18px;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: visible;
            pointer-events: none;
        }

        /* Cartoon card */
        .cartoon {
            width: 260px;
            height: 220px;
            background: linear-gradient(180deg, #fff, #f2f9ff);
            border-radius: 18px;
            box-shadow: 0 18px 40px rgba(6, 20, 40, 0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            transform-origin: center bottom;
            transform: translateY(60px) scale(.9) rotate(-6deg);
            opacity: 0;
            transition: transform .6s cubic-bezier(.2, .9, .3, 1), opacity .45s ease;
            pointer-events: auto;
        }

        .cartoon.visible {
            transform: translateY(0) scale(1) rotate(0);
            opacity: 1;
        }

        /* Simple wiggling speech bubble */
        .speech {
            position: absolute;
            top: -6px;
            right: -10px;
            background: #ffffff;
            padding: 10px 14px;
            border-radius: 14px;
            box-shadow: 0 8px 20px rgba(6, 20, 40, 0.08);
            font-weight: 600;
            font-size: 14px;
            transform-origin: left center;
            animation: bubbleWiggle 2.2s ease-in-out infinite;
            opacity: 0;
        }

        .speech.show {
            opacity: 1;
        }

        @keyframes bubbleWiggle {
            0% {
                transform: translateX(0) rotate(0deg);
            }

            25% {
                transform: translateX(-3px) rotate(-2deg);
            }

            50% {
                transform: translateX(0) rotate(0deg);
            }

            75% {
                transform: translateX(3px) rotate(2deg);
            }

            100% {
                transform: translateX(0) rotate(0deg);
            }
        }

        /* small friendly face inside the card */
        .face {
            width: 170px;
            height: 150px;
        }

        /* caption */
        .hint {
            margin-top: 12px;
            font-size: 13px;
            color: #27527a;
            opacity: .85;
        }
    </style>
</head>

<body>
    <div class="container" role="main" aria-labelledby="title">
        <h1 id="title" style="margin:0 0 6px 0;font-size:20px;">Cartoon Speaker</h1>
        <p style="margin:0;color:#345;">One button. Click and the cartoon will speak.</p>

        <div style="margin-top:14px;">
            <button id="showBtn" aria-pressed="false" aria-label="Show cartoon and speak">Show Cartoon</button>
        </div>

        <div class="stage" aria-live="polite" aria-atomic="true">
            <div id="cartoonCard" class="cartoon" role="img" aria-hidden="true">
                <svg class="face" viewBox="0 0 220 200" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                    <!-- simple cartoon character -->
                    <defs>
                        <linearGradient id="skin" x1="0" x2="1">
                            <stop offset="0" stop-color="#ffd9b3" />
                            <stop offset="1" stop-color="#ffc08a" />
                        </linearGradient>
                        <linearGradient id="hair" x1="0" x2="1">
                            <stop offset="0" stop-color="#2b2b2b" />
                            <stop offset="1" stop-color="#1f1f1f" />
                        </linearGradient>
                    </defs>

                    <rect x="10" y="12" rx="20" ry="20" width="200" height="160" fill="#eaf6ff" />
                    <g transform="translate(30,26)">
                        <ellipse cx="80" cy="64" rx="58" ry="58" fill="url(#skin)" />
                        <path d="M21 38 C40 8,120 8,139 38 C112 28,44 28,21 38 Z" fill="url(#hair)" />
                        <!-- eyes -->
                        <ellipse cx="54" cy="66" rx="8" ry="10" fill="#fff" />
                        <ellipse cx="106" cy="66" rx="8" ry="10" fill="#fff" />
                        <circle cx="54" cy="68" r="4" fill="#1b1b1b" />
                        <circle cx="106" cy="68" r="4" fill="#1b1b1b" />
                        <!-- smile -->
                        <path d="M58 92 Q82 110 106 92" stroke="#8a3b2f" stroke-width="4" fill="none"
                            stroke-linecap="round" />
                        <!-- blush -->
                        <ellipse cx="42" cy="82" rx="6" ry="4" fill="#ffc2c2" opacity="0.9" />
                        <ellipse cx="118" cy="82" rx="6" ry="4" fill="#ffc2c2" opacity="0.9" />
                    </g>
                </svg>
            </div>

            <div id="speechBubble" class="speech" aria-hidden="true">tag fast nisha </div>
        </div>

        <p class="hint">If you don't hear audio, make sure your tab isn't muted and your browser supports speech
            synthesis.</p>
    </div>

    <script>
        const btn = document.getElementById('showBtn');
        const card = document.getElementById('cartoonCard');
        const bubble = document.getElementById('speechBubble');

        // Phrase to speak
        const phraseText = "tag fast nisha ";

        // Helper: speak using Web Speech API
        function speakText(text) {
            if (!('speechSynthesis' in window)) {
                console.warn("Speech Synthesis not supported");
                return Promise.reject(new Error('No speech support'));
            }

            return new Promise((resolve) => {
                // cancel any existing utterances
                window.speechSynthesis.cancel();
                const u = new SpeechSynthesisUtterance(text);
                // choose a voice if available (prefer an english-ish voice)
                const voices = window.speechSynthesis.getVoices();
                if (voices && voices.length) {
                    // try to pick a default friendly voice (fallback to first)
                    const preferred = voices.find(v => /en|english/i.test(v.lang)) || voices[0];
                    if (preferred) u.voice = preferred;
                }
                u.rate = 1.05;
                u.pitch = 1;
                u.volume = 1;
                u.onend = () => resolve();
                u.onerror = () => resolve();
                window.speechSynthesis.speak(u);
            });
        }

        // show animation + speak on click
        async function showAndSpeak() {
            btn.disabled = true;
            btn.setAttribute('aria-pressed', 'true');
            // show cartoon
            card.classList.add('visible');
            // reveal bubble
            bubble.classList.add('show');
            bubble.setAttribute('aria-hidden', 'false');
            card.setAttribute('aria-hidden', 'false');

            try {
                await speakText(phraseText);
            } catch (e) {
                console.log('Speech failed or unsupported', e);
            }

            // keep visible briefly, then hide
            setTimeout(() => {
                bubble.classList.remove('show');
            }, 800);

            setTimeout(() => {
                card.classList.remove('visible');
                card.setAttribute('aria-hidden', 'true');
                bubble.setAttribute('aria-hidden', 'true');
                btn.disabled = false;
                btn.setAttribute('aria-pressed', 'false');
            }, 2000);
        }

        // Ensure voices are loaded (Chrome needs this event)
        function initVoices() {
            if (typeof speechSynthesis === 'undefined') return;
            // Warm up voices
            speechSynthesis.getVoices();
        }
        window.speechSynthesis && window.speechSynthesis.addEventListener && window.speechSynthesis.addEventListener('voiceschanged', initVoices);
        initVoices();

        btn.addEventListener('click', showAndSpeak);

        // Optional: allow keyboard activation
        btn.addEventListener('keyup', (e) => {
            if (e.key === 'Enter' || e.key === ' ') showAndSpeak();
        });
    </script>
</body>

</html>